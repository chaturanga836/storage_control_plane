# Storage Control Plane - Location blocks for nginx
# Include this file in both HTTP and HTTPS server blocks

# 🔐 Auth Gateway (Port 8090)
location /auth/ {
    proxy_pass http://localhost:8090/;
    rewrite ^/auth/(.*)$ /$1 break;
}

# 🏢 Tenant Node (Port 8000)  
location /data/ {
    proxy_pass http://localhost:8000/;
    rewrite ^/data/(.*)$ /$1 break;
}

# 🎯 Operation Node (Port 8081)
location /query/ {
    proxy_pass http://localhost:8081/;
    rewrite ^/query/(.*)$ /$1 break;
}

# 🧠 CBO Engine (Port 8082)
location /optimize/ {
    proxy_pass http://localhost:8082/;
    rewrite ^/optimize/(.*)$ /$1 break;
}

# 📊 Metadata Catalog (Port 8083)
location /metadata/ {
    proxy_pass http://localhost:8083/;
    rewrite ^/metadata/(.*)$ /$1 break;
}

# 📈 Monitoring (Port 8084)
location /monitor/ {
    proxy_pass http://localhost:8084/;
    rewrite ^/monitor/(.*)$ /$1 break;
}

# 🔍 Query Interpreter (Port 8085)
location /parse/ {
    proxy_pass http://localhost:8085/;
    rewrite ^/parse/(.*)$ /$1 break;
}

# Health check endpoint
location /health {
    proxy_pass http://localhost:8090/health;
}

# Version endpoint
location /version {
    proxy_pass http://localhost:8090/version;
}

# Admin interface (monitoring dashboard)
location /admin/ {
    proxy_pass http://localhost:8084/;
    rewrite ^/admin/(.*)$ /$1 break;
}
